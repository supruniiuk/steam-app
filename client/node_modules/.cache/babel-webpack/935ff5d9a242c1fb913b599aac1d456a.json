{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/shared/services/user.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"./friend-item/friend-item.component\";\nimport * as i5 from \"../../shared/pipes/search.pipe\";\n\nfunction FriendsPageComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.errorMessage, \" \");\n  }\n}\n\nfunction FriendsPageComponent_div_9_app_friend_item_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-friend-item\", 10);\n    i0.ɵɵlistener(\"removeFriend\", function FriendsPageComponent_div_9_app_friend_item_3_Template_app_friend_item_removeFriend_0_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return ctx_r6.remove($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const f_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"friend\", f_r4)(\"isFriend\", true);\n  }\n}\n\nfunction FriendsPageComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"p\", 2);\n    i0.ɵɵtext(2, \"My friends\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, FriendsPageComponent_div_9_app_friend_item_3_Template, 1, 2, \"app-friend-item\", 9);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.friendsList);\n  }\n}\n\nfunction FriendsPageComponent_div_10_app_friend_item_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-friend-item\", 12);\n    i0.ɵɵlistener(\"addFriend\", function FriendsPageComponent_div_10_app_friend_item_3_Template_app_friend_item_addFriend_0_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext(2);\n      return ctx_r11.add($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const u_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"friend\", u_r9);\n  }\n}\n\nfunction FriendsPageComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"p\", 2);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, FriendsPageComponent_div_10_app_friend_item_3_Template, 1, 1, \"app-friend-item\", 11);\n    i0.ɵɵpipe(4, \"search\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Search Friends: \", ctx_r2.srcStr, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind3(4, 2, ctx_r2.users, \"email\", ctx_r2.srcStr));\n  }\n}\n\nexport let FriendsPageComponent = /*#__PURE__*/(() => {\n  class FriendsPageComponent {\n    constructor(userService) {\n      this.userService = userService;\n      this.users = [];\n      this.errorMessage = '';\n      this.srcStr = '';\n    }\n\n    ngOnInit() {\n      this.user = this.userService.getCurrentUserInfo();\n\n      if (this.user.friendsList && this.user.friendsList.length > 0) {\n        this.friendsList = this.user.friendsList;\n      } else {\n        this.friendsList = [];\n      }\n\n      this.userService.getAllUsers().subscribe(res => {\n        this.users = Object.keys(res).map(key => {\n          res[key].id = key;\n          return res[key];\n        });\n        this.filterUsers();\n      }, err => {\n        this.errorMessage = err.message;\n        setTimeout(() => {\n          this.errorMessage = '';\n        }, 2000);\n      });\n    }\n\n    filterUsers() {\n      const friends = this.friendsList.map(f => f.id);\n      this.users = this.users.filter(u => u.email !== this.user.email && !friends.includes(u.id));\n    }\n\n    remove(exFriend) {\n      this.friendsList = this.friendsList.filter(f => f.id != exFriend.id);\n    }\n\n    add(newFriend) {\n      this.friendsList.unshift(newFriend);\n    }\n\n  }\n\n  FriendsPageComponent.ɵfac = function FriendsPageComponent_Factory(t) {\n    return new (t || FriendsPageComponent)(i0.ɵɵdirectiveInject(i1.UserService));\n  };\n\n  FriendsPageComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FriendsPageComponent,\n    selectors: [[\"app-friends-page\"]],\n    decls: 11,\n    vars: 4,\n    consts: [[1, \"custom-container\", \"bg-light\", \"p-4\"], [1, \"w-90\"], [1, \"heading-custom\", \"pb-2\"], [1, \"search\", \"input-group\", \"mb-3\"], [\"type\", \"text\", \"placeholder\", \"Search friends\", \"id\", \"basic-url\", 1, \"form-control\", \"search\", \"border-dark\", 3, \"ngModel\", \"ngModelChange\"], [1, \"btn\", \"btn-purple\", \"custom-shadow\", 3, \"click\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"alert\", \"alert-danger\"], [3, \"friend\", \"isFriend\", \"removeFriend\", 4, \"ngFor\", \"ngForOf\"], [3, \"friend\", \"isFriend\", \"removeFriend\"], [3, \"friend\", \"addFriend\", 4, \"ngFor\", \"ngForOf\"], [3, \"friend\", \"addFriend\"]],\n    template: function FriendsPageComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"p\", 2);\n        i0.ɵɵtext(3, \"Friends\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 3);\n        i0.ɵɵelementStart(5, \"input\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function FriendsPageComponent_Template_input_ngModelChange_5_listener($event) {\n          return ctx.srcStr = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"button\", 5);\n        i0.ɵɵlistener(\"click\", function FriendsPageComponent_Template_button_click_6_listener() {\n          return ctx.srcStr = \" \";\n        });\n        i0.ɵɵtext(7, \" Search \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(8, FriendsPageComponent_div_8_Template, 2, 1, \"div\", 6);\n        i0.ɵɵtemplate(9, FriendsPageComponent_div_9_Template, 4, 1, \"div\", 7);\n        i0.ɵɵtemplate(10, FriendsPageComponent_div_10_Template, 5, 6, \"div\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.srcStr);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.friendsList && !ctx.srcStr);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.users && ctx.srcStr || ctx.users && ctx.friendsList.length == 0 && !ctx.srcStr);\n      }\n    },\n    directives: [i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgModel, i3.NgIf, i3.NgForOf, i4.FriendItemComponent],\n    pipes: [i5.SearchPipe],\n    encapsulation: 2\n  });\n  return FriendsPageComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}